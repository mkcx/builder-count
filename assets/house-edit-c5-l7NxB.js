import{_ as te,k as oe,u as ne,f as ae,g,l as k,q as S,n as le,p as ie,r as u,o as E,c as U,d as a,i as l,a as e,F as ce,b as de,w as d,e as x,t as r,v as re,x as ue,s as D}from"./index-7Vuxo2L6.js";import{e as _e,s as pe}from"./Export2Excel-gLb2Sem2.js";const i=y=>(re("data-v-92fdf672"),y=y(),ue(),y),he={class:"house-edit flex fd-c"},fe={class:"list fx-1"},me={class:"card__header flex ai-c"},ve={class:"card__name fx-1 flex ai-c"},xe=i(()=>e("span",null,"方块名称：",-1)),ye={class:"flex fs-0"},we={class:"card__item flex ai-c"},Ce=i(()=>e("span",{class:"fs-0"},"方块形状：",-1)),ge={class:"fx-1"},ke={class:"card__item flex ai-c"},qe=i(()=>e("span",{class:"fs-0"},"面积类型：",-1)),Ve={class:"fx-1"},be={class:"card__item flex ai-c"},Te=i(()=>e("span",{class:"fs-0"},"方块长度：",-1)),Be={class:"fx-1"},Se=i(()=>e("span",null,"m",-1)),Ee={class:"card__item flex ai-c"},Ue=i(()=>e("span",{class:"fs-0"},"方块宽度：",-1)),De={class:"fx-1"},Le=i(()=>e("span",null,"m",-1)),Ie={class:"card__item flex ai-c"},Oe=i(()=>e("span",{class:"fs-0"}," 面积： ",-1)),Pe={class:"fx-1"},Re=i(()=>e("span",null,[x("m"),e("sup",null,"2")],-1)),$e={class:"footer fs-0 flex ai-c jc-sb"},Ae={class:"footer__total"},Ke=i(()=>e("sup",null,"2",-1)),Ne={class:"form"},Fe={class:"form__title"},je={class:"form__item"},He={class:"form__item"},Je={class:"form__item"},Me={class:"form__item"},We=i(()=>e("span",null,"m",-1)),ze={class:"form__item"},Ge=i(()=>e("span",null,"m",-1)),Qe={class:"form__footer"},Xe={__name:"house-edit",setup(y){const p=oe(),$=ne(),w=ae(),h=g(!1),A=[{text:"矩形",value:1},{text:"三角形",value:2}],K=t=>{const s=t.selectedOptions[0];o.shape=s.value,o.shapeText=s.text,h.value=!1},N=()=>{h.value=!1},q=t=>({1:"矩形",2:"三角形"})[t],f=g(!1),F=[{text:"有效面积",value:1},{text:"剔除面积",value:-1}],j=t=>{const s=t.selectedOptions[0];o.type=s.value,o.typeText=s.text,f.value=!1},H=()=>{f.value=!1},L=t=>({1:"有效面积","-1":"剔除面积"})[t],m=g(!1),V={houseId:w.query.id,uniqid:"",name:"",length:1,width:1,type:1,typeText:"有效面积",shape:1,shapeText:"矩形"};let o=k(S(V));const J=()=>{m.value=!0},M=t=>{pe({title:"温馨提示",message:"删除后无法恢复，请确认是否继续"}).then(()=>{p.commit("square/DELETE_BLOCK",{uniqid:t}),b()}).catch(()=>{})},W=t=>{o=k({...t}),o.shapeText=q(t.shape),o.typeText=L(t.type),m.value=!0},z=()=>{$.back()},G=()=>{const t={name:"房间名称",shape:"形状",type:"是否剔除",length:"长",width:"宽",square:"面积"},s=["name","shape","type","length","width","square"],_=C.value.map(c=>({name:c.name,shape:q(c.shape),type:c.type===-1?"是":"否",length:c.length,width:c.width,square:T(c)}));_e({header:t,data:_,key:s,title:"",filename:w.query.name+"的全部方块",autoWidth:!1})},Q=()=>{if(o.name.trim()===""){D("请输入方块名称");return}if(o.length.trim()===""){D("请输入方块长度");return}if(o.width.trim()===""){D("请输入方块宽度");return}o.uniqid?p.commit("square/UPDATE_BLOCK",o):p.commit("square/ADD_BLOCK",o),o=k(S(V)),m.value=!1,b()},X=()=>{o=k(S(V)),m.value=!1},Y=p.state.square.house.find(t=>t.uniqid===w.query.id),C=g([]),Z=le(()=>C.value.reduce((s,_)=>{const c=T(_);return s+=c*_.type,s},0)),b=()=>{C.value=p.state.square.block.filter(t=>t.houseId===w.query.id)},I={rectangle(t,s){return t*s},triangle(t,s){return t*s/2}},T=t=>t.shape===1?I.rectangle(t.length,t.width):t.shape===2?I.rectangle(t.length,t.width)/2:0;return ie(()=>{b()}),(t,s)=>{var R;const _=u("van-nav-bar"),c=u("van-icon"),B=u("van-button"),v=u("van-field"),ee=u("van-overlay"),O=u("van-picker"),P=u("van-popup");return E(),U("div",he,[a(_,{class:"fs-0",title:((R=l(Y))==null?void 0:R.name)||"","left-text":"返回","right-text":"导出","left-arrow":"",onClickLeft:z,onClickRight:G},null,8,["title"]),e("div",fe,[(E(!0),U(ce,null,de(C.value,n=>(E(),U("div",{key:n.uniqid,class:"card"},[e("div",me,[e("div",ve,[xe,e("span",null,r(n.name),1)]),e("div",ye,[a(c,{class:"mr-10",name:"edit",onClick:se=>W(n)},null,8,["onClick"]),a(c,{name:"delete-o",color:"red",onClick:se=>M(n.uniqid)},null,8,["onClick"])])]),e("div",we,[Ce,e("span",ge,r(q(n.shape)),1)]),e("div",ke,[qe,e("span",Ve,r(L(n.type)),1)]),e("div",be,[Te,e("span",Be,r(n.length),1),Se]),e("div",Ee,[Ue,e("span",De,r(n.width),1),Le]),e("div",Ie,[Oe,e("span",Pe,r(T(n)),1),Re])]))),128))]),e("div",$e,[a(B,{class:"btn",type:"primary",icon:"plus",onClick:J},{default:d(()=>[x("新增形状")]),_:1}),e("div",Ae,[e("span",null,[x("合计："+r(Z.value)+" m",1),Ke])])]),a(ee,{show:m.value,class:"modal"},{default:d(()=>[e("div",Ne,[e("div",Fe,r(l(o).uniqid?"编辑":"新增")+"方块",1),e("div",je,[a(v,{modelValue:l(o).name,"onUpdate:modelValue":s[0]||(s[0]=n=>l(o).name=n),class:"form__input",label:"方块名称",placeholder:"请输入方块名称"},null,8,["modelValue"])]),e("div",He,[a(v,{modelValue:l(o).shapeText,"onUpdate:modelValue":s[1]||(s[1]=n=>l(o).shapeText=n),readonly:"",class:"form__input",label:"方块形状",placeholder:"选择方块形状","right-icon":"arrow-down",onClick:s[2]||(s[2]=n=>h.value=!0)},null,8,["modelValue"])]),e("div",Je,[a(v,{modelValue:l(o).typeText,"onUpdate:modelValue":s[3]||(s[3]=n=>l(o).typeText=n),readonly:"",class:"form__input",label:"面积类型",placeholder:"选择面积类型","right-icon":"arrow-down",onClick:s[4]||(s[4]=n=>f.value=!0)},null,8,["modelValue"])]),e("div",Me,[a(v,{modelValue:l(o).length,"onUpdate:modelValue":s[5]||(s[5]=n=>l(o).length=n),class:"form__input",label:"方块长度",placeholder:"请输入方块长度"},{"right-icon":d(()=>[We]),_:1},8,["modelValue"])]),e("div",ze,[a(v,{modelValue:l(o).width,"onUpdate:modelValue":s[6]||(s[6]=n=>l(o).width=n),class:"form__input",label:"方块宽度",placeholder:"请输入方块宽度"},{"right-icon":d(()=>[Ge]),_:1},8,["modelValue"])]),e("div",Qe,[a(B,{class:"form__btn",plain:"",type:"primary",onClick:X},{default:d(()=>[x("取消")]),_:1}),a(B,{class:"form__btn",type:"primary",onClick:Q},{default:d(()=>[x("确定")]),_:1})])])]),_:1},8,["show"]),a(P,{show:h.value,"onUpdate:show":s[7]||(s[7]=n=>h.value=n),position:"bottom",round:"",style:{height:"30%"}},{default:d(()=>[a(O,{title:"方块形状",columns:A,onConfirm:K,onCancel:N})]),_:1},8,["show"]),a(P,{show:f.value,"onUpdate:show":s[8]||(s[8]=n=>f.value=n),position:"bottom",round:"",style:{height:"30%"}},{default:d(()=>[a(O,{title:"面积类型",columns:F,onConfirm:j,onCancel:H})]),_:1},8,["show"])])}}},es=te(Xe,[["__scopeId","data-v-92fdf672"]]);export{es as default};
